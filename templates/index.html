<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>index</title>
    <script type="text/javascript" src="../static/js/jquery.js"></script>
    <link rel="stylesheet" href="../static/css/comon0.css" />
  </head>
  <script>
    $(window).load(function () {
      $(".loading").fadeOut();
    });

    /****/
    $(document).ready(function () {
      var whei = $(window).width();
      $("html").css({ fontSize: whei / 20 });
      $(window).resize(function () {
        var whei = $(window).width();
        $("html").css({ fontSize: whei / 20 });
      });
    });
  </script>
  <script type="text/javascript" src="../static/js/echarts.min.js"></script>
  <script type="text/javascript" src="../static/js/china.js"></script>
  <script type="text/javascript" src="../static/js/chroma.min.js"></script>
  <body>
    <div class="canvas" style="opacity: 0.2">
      <iframe
        frameborder="0"
        src="../static/js/index.html"
        style="width: 100%; height: 100%"
      ></iframe>
    </div>
    <div class="loading">
      <div class="loadbox">
        <img src="../static/picture/loading.gif" /> 页面加载中...
      </div>
    </div>
    <div class="head">
      <h1>空间利用率情况展示</h1>
      <div class="weather">
        <!--        <img src="picture/weather.png"><span>多云转小雨</span>-->
        <span id="showTime"></span>
      </div>

      <script>
        var t = null;
        t = setTimeout(time, 1000); //開始运行
        function time() {
          clearTimeout(t); //清除定时器
          dt = new Date();
          var y = dt.getFullYear();
          var mt = dt.getMonth() + 1;
          var day = dt.getDate();
          var h = dt.getHours(); //获取时
          var m = dt.getMinutes(); //获取分
          var s = dt.getSeconds(); //获取秒
          document.getElementById("showTime").innerHTML =
            y +
            "年" +
            mt +
            "月" +
            day +
            "日" +
            "-" +
            h +
            "时" +
            m +
            "分" +
            s +
            "秒";
          t = setTimeout(time, 1000); //设定定时器，循环运行
        }
      </script>
    </div>
    <div class="mainbox">
      <ul class="clearfix">
        <li>
          <div class="map">
            <div class="map1"><img src="../static/picture/lbx.png" /></div>
            <div class="map2"><img src="../static/picture/jt.png" /></div>
            <div class="map3"><img src="../static/picture/map.png" /></div>
          </div>
        </li>
        <li>
          <div class="piechart">
            <div class="alltitle">当前图书馆在馆人数情况</div>
            <div class="allnav" id="fb1"></div>
            <div class="boxfoot"></div>
            <div class="boxfoot"></div>
          </div>
        </li>
        <li>
          <div class="barchart">
            <div class="alltitle">图书馆各学院在馆人数TOP10</div>
            <div class="allnav" id="fb2"></div>
            <div class="boxfoot"></div>
            <div class="boxfoot"></div>
          </div>
        </li>
        <li>
          <div class="linechart">
            <div class="alltitle">空间利用率时间变化趋势</div>
            <div class="allnav" id="echart4"></div>
            <div class="boxfoot"></div>
          </div>
        </li>
      </ul>
    </div>
    <div class="back"></div>
    <!--echarts3_1-->
    <script>
      $(function echarts_31() {
        // 基于准备好的dom，初始化echarts实例
        var echarts_31 = echarts.init(document.getElementById('fb1'));
        option = {
          tooltip: {
              trigger: 'item',
              formatter: "{b}: {c} ({d}%)",
              position:function(p){   //其中p为当前鼠标的位置
              return [p[0] + 10, p[1] - 10];
              }
          },
          legend: {
              top:'0%',
              data:{{form.echarts3_1.xAxis|safe}},
              textStyle: {
                  color: 'rgba(255,255,255,.5)',
                  fontSize:'12',
              }
          },
          series: [
              {
              	name:'{{form.echarts3_1.title}}',
                type:'pie',
                color: ['#065aab', '#066eab', '#0682ab', '#0696ab', '#06a0ab','#06b4ab','#06c8ab','#06dcab','#06f0ab'],
                label: {
                  show: true,  // 显示标签
                  position: 'inside',  // 标签显示在饼图内部
                  formatter: '{b}:{c}({d}%)',  // 设置标签的显示格式
                  textStyle: {
                    color: 'rgba(255,255,255,.5)',  // 标签文字颜色
                    fontSize:'14',
                  }
                },
                labelLine: {show:false},
                data:{{form.echarts3_1.data|safe}}
              }
          ]
      };
          // 使用刚指定的配置项和数据显示图表。
          echarts_31.setOption(option);
          window.addEventListener("resize",function(){
              echarts_31.resize();
          });
      })
    </script>
    <!-- echart3_2 -->
    <script>
      $(function echarts_32() {
          var echarts_32 = echarts.init(document.getElementById('fb2'));
          option = {
              tooltip: {
                  trigger: 'axis',
                  axisPointer: {
                      type: 'shadow'
                  }
              },
              grid: {
                  top:'10%',
                  left: '3%',
                  right: '3%',
                  bottom: '3%', //调整边距，使柱状图能够更好地占据块内的空间
                  containLabel: true
              },
              yAxis: {
                  type: 'value',
                  axisLine: {
                      lineStyle: {
                          color: 'rgba(255,255,255,.5)',
                      }
                  },
                  axisLabel: {
                      textStyle: {
                          color: 'rgba(255,255,255,.5)',
                          fontSize:'12',
                      }
                  },
                  splitLine: {
                      lineStyle: {
                          color: 'rgba(255,255,255,.1)',
                      }
                  }
              },
              legend: {
                  // top:'0%',
                  data: {{form.echarts3_2.xAxis|safe}},
                  textStyle: {
                      color: 'rgba(255,255,255,.5)',
                      fontSize:'12',
                  }
              },
              xAxis: {
                  type: 'category',
                  data: {{form.echarts3_2.data|safe}},
                  axisLine: {
                      lineStyle: {
                          color: 'rgba(255,255,255,.5)',
                      }
                  },
                  axisLabel: {
                      textStyle: {
                        show: true,
                          color: 'rgba(255,255,255,.5)',
                          fontSize:'12',
                      }
                  }
              },
              series: [
                  {
                      name: '{{form.echarts3_2.title}}',
                      type: 'bar',
                      barWidth: '100%', //柱子宽度
                      // barGap: 1, //柱子之间间距
                    itemStyle: {
                        color: function(params) {
                            // 定义基准颜色
                            var baseColor1 = '#087a73';
                            var baseColor2 = '#6a1479';
                            // 生成颜色插值器
                            var colorInterpolator = chroma.scale([baseColor1, baseColor2]).mode('lch').colors(10);
                            // 定义颜色数组
                            var colorList = colorInterpolator.map(function(color) {
                                return color;
                            });
                            return colorList[params.dataIndex % colorList.length];
                        }
                    },
                      label: {
                        show: true,  // 显示标签
                        position: 'outside',  // 标签显示在直方图外部
                        formatter: '{b}',  // 设置标签的显示格式
                        textStyle: {
                          color: 'rgba(255,255,255,.5)',  // 标签文字颜色
                          fontSize:'12',
                        }
                      },
                      data: {{form.echarts3_2.data|safe}}
                  }
              ]
          };
          echarts_32.setOption(option);
          window.addEventListener("resize",function(){
              echarts_32.resize();
          });
      })
    </script>
    <!--echarts4-->
    <script>
      $(function echarts_4() {
          // 基于准备好的dom，初始化echarts实例
          var echarts_4 = echarts.init(document.getElementById('echart4'));
          option = {
      	    tooltip: {
              trigger: 'axis',
              axisPointer: {
                  lineStyle: {
                      color: '#dddc6b'
                  }
              },
              formatter: function(params) {
            var result = params[0].name + '<br/>'; // x轴数据
                for (var i = 0; i < params.length; i++) {
                    var seriesName = params[i].seriesName; // 系列名称
                    var value = params[i].value; // 数据值
                    result += seriesName + ': ' + value + '%<br/>'; // 拼接每个系列的名称和数据值
                }
                return result;
            }
          },
          grid: {
              left: '10',
      		    top: '30',
              right: '10',
              bottom: '10',
              containLabel: true
          },
          xAxis: [{
              type: 'category',
              boundaryGap: false,
              axisLabel:  {
                  textStyle: {
                      color: "rgba(255,255,255,.6)",
                      fontSize:12,
                  },
              },
              axisLine: {
      			lineStyle: {
      				color: 'rgba(255,255,255,.2)'
      			}
              },
              data: {{form.echart4.xAxis|safe}}
          }, {
              axisPointer: {show: false},
              axisLine: {show: false},
              position: 'bottom',
              offset: 20,
          }],
          yAxis: [{
              type: 'value',
              min: 0,         // 设置最小值为0
              max: 100,      // 设置最大值为100
              axisTick: {show: false},
              axisLine: {
                  lineStyle: {
                      color: 'rgba(255,255,255,.1)'
                  }
              },
              axisLabel:  {
                  formatter: '{value}%',  // 设置刻度标签的格式为百分比形式
                  textStyle: {
                      color: "rgba(255,255,255,.6)",
                      fontSize:12,
                  },
              },
              splitLine: {
                  lineStyle: {
                       color: 'rgba(255,255,255,.1)'
                  }
              },
          }],
          legend: {
              right:'0%',
              data:{{form.echart4.names|safe}},
              textStyle: {
                  color: 'rgba(255,255,255,.5)',
                  fontSize:'12',
              }
          },
          series: [
      	{
              name: '时段在馆人数/总座位数',
              data: {{form.echart4.data[0].value|safe}},
              type: 'line',
              smooth: true,
              symbol: 'circle',
              symbolSize: 5,
              showSymbol: false,
              lineStyle: {
                  normal: {
      				color: '#0184d5',
                      width: 2
                  }
              },
              areaStyle: {
                  normal: {
                      color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                          offset: 0,
                          color: 'rgba(1, 132, 213, 0.4)'
                      }, {
                          offset: 0.8,
                          color: 'rgba(1, 132, 213, 0.1)'
                      }], false),
                      shadowColor: 'rgba(0, 0, 0, 0.1)',
                  }
              },
      			itemStyle: {
      			normal: {
      				color: '#0184d5',
      				borderColor: 'rgba(221, 220, 107, .1)',
      				borderWidth: 12
      			}
      		},
              label: {
                      show: true, // 显示标签
                      position: 'top', // 标签位置，默认值是 'top'
                      formatter: '{c}%', // 标签格式化函数，这里表示显示数据值并加上百分号
                      textStyle: {
                          color: 'rgba(255, 255, 255, .7)', // 标签文字颜色
                          fontSize: 12 // 标签文字字号
                      }
                  }
          },
      ]
      };
          // 使用刚指定的配置项和数据显示图表。
          echarts_4.setOption(option);
          window.addEventListener("resize",function(){
              echarts_4.resize();
          });
      })
    </script>
  </body>
</html>
